/*!
 * hoverIntent v1.8.0 // 2014.06.29 // jQuery v1.9.1+
 * http://cherne.net/brian/resources/jquery.hoverIntent.html
 *
 * You may use hoverIntent under the terms of the MIT license. Basically that
 * means you are free to use hoverIntent as long as this header is left intact.
 * Copyright 2007, 2014 Brian Cherne
 */
function initGiftQuestionHandler(){$(".gift-filter__block:not(:first-child)").show(),calculateGiftQuestionWidth(),$(window).resize(calculateGiftQuestionWidth),$(".gift-filter__option").on("click",function(){return $(this).is(".gift-filter__block:visible:last a")?($(this).closest(".gift-filter__block").fadeTo(200,0),$(".gift-filter__complete").removeClass("hide-slide")):(gf_slide_translate-=gf_question_width,$("#js-question-slide-container").css("transform","translateX("+gf_slide_translate+"px)")),$("<input>").attr({type:"hidden",name:"tags[]",value:$(this).attr("data-tagname")}).appendTo("form#js-filter_form"),freshCollections(!0,!0),!1}),$("#collections_wrapper, .collection_active_filters_mobile").on("click",".filter-remove-link",function(){var t=$(this).attr("data-filter-item"),e=!0,i=!0,n=!0,a=["gf-wife","gf-girlfriend","gf-friend","gf-husband","gf-boyfriend"],o=["rings","necklaces","earrings","charms","bracelets","cufflinks"],l=["gf-classic","gf-modern","gf-girly","gf-romantic","gf-casual","gf-trendy","gf-sophisticated"];$("#collections_selected_filters_row").find(".filter-remove-link").each(function(r,s){var s=$(this).attr("data-filter-item");t!=s&&(a.indexOf(s)>-1?e=!1:o.indexOf(s)>-1?i=!1:l.indexOf(s)>-1&&(n=!1))}),e?$("#js-slide-1").show().fadeTo(100,1).removeClass("hide-slide"):$("#js-slide-1").hide(),i?$("#js-slide-2").show().fadeTo(100,1).removeClass("hide-slide"):$("#js-slide-2").hide(),n?$("#js-slide-3").show().fadeTo(100,1).removeClass("hide-slide"):$("#js-slide-3").hide(),gf_slide_translate=0,$(".gift-filter__complete").addClass("hide-slide"),$("#js-question-slide-container").css("transform","translateX(0)"),freshCollections(!0,!0)})}function calculateGiftQuestionWidth(){gf_slide_translate<0&&(gf_slide_translate=gf_slide_translate/gf_question_width*$(".gift-filter-wrapper").width(),$("#js-question-slide-container").css("transform","translateX("+gf_slide_translate+"px)")),gf_question_width=$(".gift-filter-wrapper").width(),gf_question_count=$(".gift-filter__block").length,gf_question_total_width=gf_question_count*gf_question_width,$(".gift-filter__block").css("width",gf_question_width),$("#js-question-slide-container").css("width",gf_question_total_width)}function initClickHandlers(){$("#collections_wrapper").on("click","a.filter-links",function(){return $("<input>").attr({type:"hidden",name:"tags[]",value:$(this).attr("data-tagname")}).appendTo("form#js-filter_form"),$("#page").val("1"),freshCollections(!0,!1),!1}),$("#collections_wrapper").on("click",".filter-remove-link",function(){return $("input[value="+$(this).attr("data-filter-item")+"]").remove(),$("#page").val("1"),"gf-"==$(this).attr("data-filter-item").substring(0,3)?freshCollections(!0,!0):freshCollections(!0,!1),!1}),$("#collections_wrapper").on("click","a.sort-links",function(){return $("input[name=sort]").val($(this).data("sort")),freshCollections(!0,!1),!1}),$("#collections_wrapper").on("change",".filter-sort-select",function(){return $("input[name=sort]").val($(this).val()),freshCollections(!0,!1),!1}),$("#collections_wrapper").on("click","ul.pagination a",function(){return"#"!=$(this).attr("href")&&($("#js-filter_form input[name=page]").val($(this).attr("href").split("page=")[1].split("&")[0]),freshCollections(!0,!1)),!1}),$("#collections_wrapper").on("change",".filter-page-select",function(){return $("input[name=page]").val($(this).val()),freshCollections(!0,!1),!1}),$("#collections_wrapper").on("click",".filter-show-more-links",function(){return $(this).parent().parent().find("li").show(),$(this).remove(),!1}),$("#collections_wrapper").on("click",".filter-hide-more-links",function(){return $(this).parent().parent().find("li:gt(5)").hide(),$(this).parent().parent().append('<li><a href="#" class="filter-show-more-links">More Options <i class="fa fa-sort-down"></i></a></li>').show(),!1}),$("#collections_wrapper").on("click","[data-toggle=offcanvas]",function(){return $(".row-offcanvas").toggleClass("active"),goToByScroll("body"),!1}),refreshClickHandlers()}function refreshClickHandlers(){$("#content_container").on("click","#desktop_filter_link, #mobile_filter_link, #close_filter_link",function(){return $("#sort_container").hide(),$("#desktop_sort_link i").attr("class","icon-caret-down"),$(window).width(),$("#filter_container").toggle(),$("#desktop_filter_link i").toggleClass("icon-caret-down").toggleClass("icon-caret-up"),$("#mobile_filter_link").toggleClass("active"),$("#mobile_filter_link").hasClass("active")?lastScrollPos=$(document).scrollTop():Modernizr.touch&&($("html, body").animate({scrollTop:lastScrollPos},1),lastScrollPos=0),"desktop_filter_link"!=event.target.id&&$("body").toggleClass("noscroll"),!1}),$("#content_container").on("click",".product__ad-link",function(){return submit_ga_event_click("Ads","Ad Click",$(this).data("ad-name")),window.href=$(this).prop("href"),!1}),$("#content_container").on("click","#desktop_sort_link",function(){return $("#filter_container").hide(),$("#desktop_filter_link i").attr("class","icon-caret-down"),$("#mobile_filter_link").removeClass("active"),$("#sort_container").toggle(),$("body").removeClass("noscroll"),$("i",this).toggleClass("icon-caret-down").toggleClass("icon-caret-up"),!1}),$("#content_container").on("click","li.product-item a",function(){submit_ga_event_click("Collections","Viewed Product","Style Code",$(this).data("style-code"));var t=($(this).data("cslug"),$(this).data("style-code"),$(this).data("cidx"),$(this).data("cpg"),$("#js-filter_form").serializeObject());t["tags[]"];return!1}),$("#content_container").on("change","#mobile_sort_select",function(){$("#sort").val($("option:selected",this).val()),$("#filter_container").hide(),$("#desktop_filter_link i").attr("class","icon-caret-down"),$("#mobile_filter_link").removeClass("active"),$("body").removeClass("noscroll"),freshCollections(!0,!1)}),$("#content_container").on("change","#mobile_view_select",function(){val=$("option:selected",this).val(),"1"==val?($(".product-item").addClass("pure-u-1-1").removeClass("pure-u-1-2"),$("#view").val("1"),Cookies.set("collectionView",1)):($(".product-item").addClass("pure-u-1-2").removeClass("pure-u-1-1"),$("#view").val("2"),Cookies.set("collectionView",2)),lastScrollPos=0,$("#mobile_filter_link").click()}),Modernizr.touch||$(".product-item").hoverIntent(function(){hoverDisabled||(img=$(this).find("img"),img.data("orig_src",img.attr("src")),img.attr("src",img.attr("data-alt-image-src")),$(this).is(":nth-child(3n+3)"))},function(){hoverDisabled||(img=$(this).find("img"),img.attr("src",img.data("orig_src")))})}function freshCollections(t,e){$("#collections_main_row").addClass("loading-status"),$("#collections_item_container .loading-icon").show(),$("#sort_container,#filter_container").hide(),$("#desktop_filter_link i, #desktop_sort_link i").attr("class","icon-caret-down");var i="/"+$("input[name=collection_name]").val();$("input[name=seo_title_name]").is("*")&&(i="/"+$("input[name=seo_title_name]").val()+i),"m"===window.location.pathname.split("/")[1]&&(i="/m"+i);var n=$("#js-filter_form").serialize();!0===t&&(n+="&reload=true"),$.ajax({url:i,type:"GET",cache:!1,data:n,success:function(t){$("body").removeClass("noscroll"),e||submit_ga_tracker(i+"?"+n),"undefined"!=typeof history.pushState&&history.pushState(null,null,i+"?"+$("#js-filter_form").serialize());var a=t.collection_content;$("#collections_wrapper").html(a),infinite_scroll_enabled&&$(".collections-pagination-sort-div").hide(),$("#collections_main_row").removeClass("loading-status"),$("#collections_item_container .loading-icon").hide(),e||($(window).width()<768?goToByScroll("body"):goToByScroll("collections_item_container")),infinite_scroll_enabled?(null==current_url&&(current_url=t.curr_data_url),next_data_url=t.next_data_url,curr_data_url=t.curr_data_url,prev_data_url=t.prev_data_url,next_data_cache=!1,null!=next_data_url?$.getJSON("/ajax"+next_data_url,function(t){next_data_cache=t}):$("#loading_more").hide()):$("#loading_more").hide(),$(".item_badge").animate({opacity:.9999},3e3),redrawPrices()},error:function(){}})}function redrawPrices(){adjust<1&&($(".label-features:not(:has(.label-sale-item))").prepend('<span class="item_badge label label-sale-item">ON SALE</span>'),$(".label-sale-item").css("display","inline"),$(".item-price").each(function(){$(this).html('<div class="sale-price">SALE PRICE: '+number_to_currency($(this).data("price")*adjust,{precision:2})+"</div>")}))}function disableHover(){hoverDisabled=!0}function load_previous_scroll_pages(t){prev_data_url=t.data("prev-data-url"),""!=prev_data_url&&null!=prev_data_url?(is_loading=!0,$("#loading_modal").show(),$.getJSON("/ajax"+prev_data_url,function(e){t.before('<ul class="collection-pages thumbnails list-unstyled" data-current-page-num="'+e.current_page_num+'" data-next-data-url="'+e.next_data_url+'" data-curr-data-url="'+e.curr_data_url+'" data-prev-data-url="'+e.prev_data_url+'">'+e.collection_content+"</ul>"),load_previous_scroll_pages($(".collection-pages:first"))})):(is_loading=!1,$("#loading_modal").hide(),0!=last_scroll?window.scrollTo(0,last_scroll):t.data("current-page-num")!=$(".collection-pages:last").data("current-page-num")&&$("html, body").animate({scrollTop:$(".init-scroll").offset().top},1e3))}function fix_mobile_collections_actions_bar(){}function initialize_scroll_handlers(){$("#collections_content li.product-item").each(function(){!$(this).data("impressioned")&&mostlyVisible($(this))&&logImpression($(this))}),$(window).width()<768?(last_scroll=window.pageYOffset,first_loaded_page=$(".collection-pages:first"),first_loaded_page.addClass("init-scroll"),load_previous_scroll_pages(first_loaded_page),$(window).scroll(function(){if(fix_mobile_collections_actions_bar(),$(".collection-pages").is("*")){var t=$(window).scrollTop();t>=$(".collection-pages:last").offset().top+.5*$(".collection-pages:last").height()&&(is_loading||($("#loading_more").show(),load_more_items())),Math.abs(t-last_scroll)>.1*$(window).height()&&(last_scroll=t,$(".collection-pages").each(function(){if(mostlyVisible($(this)))return current_url!==$(this).data("curr-data-url")&&(current_url=$(this).data("curr-data-url"),submit_ga_tracker(current_url),"undefined"!=typeof history.replaceState&&history.replaceState(null,null,$(this).data("curr-data-url"))),$(this).children("li.product-item").each(function(){!$(this).data("impressioned")&&mostlyVisible($(this))&&logImpression($(this))}),!1}))}}),infinite_scroll_enabled=!0):$(window).scroll(function(){$("#collections_content li.product-item").each(function(){!$(this).data("impressioned")&&mostlyVisible($(this))&&logImpression($(this))})})}function load_more_items(){is_loading=!0,null!=next_data_url&&""!==next_data_url?next_data_cache?(is_loading=!1,fetch_more_items(next_data_cache)):$.getJSON("/ajax"+next_data_url,function(t){is_loading=!1,fetch_more_items(t)}):$("#loading_more").hide()}function fetch_more_items(t){$(".collection-pages:last").after('<ul class="pure-g collection-pages thumbnails list-unstyled" data-current-page-num="'+t.current_page_num+'" data-next-data-url="'+t.next_data_url+'" data-curr-data-url="'+t.curr_data_url+'" data-prev-data-url="'+t.prev_data_url+'">'+t.collection_content+"</ul>"),next_data_url=t.next_data_url,curr_data_url=t.curr_data_url,prev_data_url=t.prev_data_url,next_data_cache=!1,null!=next_data_url?(is_loading=!0,$("#loading_more").show(),$.getJSON("/ajax"+next_data_url,function(t){is_loading=!1,next_data_cache=t})):$("#loading_more").hide(),$(".item_badge").animate({opacity:.9999},3e3)}function mostlyVisible(t){var e=$(window).scrollTop(),i=$(window).height(),n=$(t).offset().top,a=$(t).height();return n+a-.25*a>e&&n<e+.5*i}function logImpression(t){"undefined"!=typeof ga&&ga.hasOwnProperty("loaded")&&!0===ga.loaded&&(t.data("impressioned")||(t.data("impressioned",!0),ga("ec:addImpression",{name:t.attr("data-style-code"),list:t.attr("data-list"),position:t.attr("data-list-pos")}),ga("send","event","ProductList","impression",{nonInteraction:!0})))}!function(t){t.fn.hoverIntent=function(e,i,n){var a={interval:100,sensitivity:6,timeout:0};a="object"==typeof e?t.extend(a,e):t.isFunction(i)?t.extend(a,{over:e,out:i,selector:n}):t.extend(a,{over:e,out:e,selector:i});var o,l,r,s,c=function(t){o=t.pageX,l=t.pageY},d=function(e,i){if(i.hoverIntent_t=clearTimeout(i.hoverIntent_t),Math.sqrt((r-o)*(r-o)+(s-l)*(s-l))<a.sensitivity)return t(i).off("mousemove.hoverIntent",c),i.hoverIntent_s=!0,a.over.apply(i,[e]);r=o,s=l,i.hoverIntent_t=setTimeout(function(){d(e,i)},a.interval)},_=function(t,e){return e.hoverIntent_t=clearTimeout(e.hoverIntent_t),e.hoverIntent_s=!1,a.out.apply(e,[t])},u=function(e){var i=t.extend({},e),n=this;n.hoverIntent_t&&(n.hoverIntent_t=clearTimeout(n.hoverIntent_t)),"mouseenter"===e.type?(r=i.pageX,s=i.pageY,t(n).on("mousemove.hoverIntent",c),n.hoverIntent_s||(n.hoverIntent_t=setTimeout(function(){d(i,n)},a.interval))):(t(n).off("mousemove.hoverIntent",c),n.hoverIntent_s&&(n.hoverIntent_t=setTimeout(function(){_(i,n)},a.timeout)))};return this.on({"mouseenter.hoverIntent":u,"mouseleave.hoverIntent":u},a.selector)}}(jQuery);var hoverDisabled=!1,infinite_scroll_enabled=!1,current_url=null,current_page_num,next_data_url,next_data_cache,prev_data_cache,last_scroll=0,is_loading=!1,gf_question_count=0,gf_question_width=0,gf_question_total_width=0,gf_slide_translate=0;$(function(){window.onbeforeunload=disableHover,initClickHandlers(),initGiftQuestionHandler(),current_url=$(".collection-pages:first").data("curr-data-url"),next_data_url=$(".collection-pages:first").data("next-data-url"),initialize_scroll_handlers(),$(".item_badge").animate({opacity:.9999},3e3),redrawPrices();try{var t=window.location.pathname.split("/")[1];submit_ga_event_click("Page","Viewed Collection","Collection",t)}catch(t){}});var lastScrollPos=0;